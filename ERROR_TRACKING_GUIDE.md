# ๐ ุฏููู ูุธุงู ุชุชุจุน ุงูุฃุฎุทุงุก ุงููุชูุฏู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ูุธุงู ุชุชุจุน ุฃุฎุทุงุก ูุชูุฏู ููุจูุช ูุณูุญ ุจู:
- โ ุชุชุจุน ุฌููุน ุงูุฃุฎุทุงุก ุชููุงุฆูุงู
- โ ุชุตููู ุงูุฃุฎุทุงุก ุญุณุจ ุงูููุน ูุงูููุตุฉ
- โ ุนุฑุถ ุฅุญุตุงุฆูุงุช ููุตูุฉ ูููุฏูุฑ
- โ ุญูุธ ุงูุฃุฎุทุงุก ูู ููู JSON
- โ Logging ูุญุณูู ูุชุชุจุน ุงููุดุงูู

---

## ๐ฏ ูููุฏูุฑ - ููู ุชุณุชุฎุฏู ุงููุธุงูุ

### 1๏ธโฃ ุนุฑุถ ุชูุฑูุฑ ุงูุฃุฎุทุงุก

```
/errors
```

ุณูุนุฑุถ ูู:
- ๐ ุฅุฌูุงูู ุงูุฃุฎุทุงุก ูู ุขุฎุฑ 24 ุณุงุนุฉ
- ๐น ุชุตููู ุญุณุจ ุงูููุน (download_facebook, download_instagram, etc.)
- ๐ธ ุชุตููู ุญุณุจ ุงููุฆุฉ (unsupported_url, private_content, etc.)
- ๐ ุชุตููู ุญุณุจ ุงูููุตุฉ

### 2๏ธโฃ ุนุฑุถ ุชูุงุตูู ุงูุฃุฎุทุงุก

ุจุนุฏ ุฅุฑุณุงู `/errors`ุ ุงุณุชุฎุฏู ุงูุฃุฒุฑุงุฑ:

- **๐ ุขุฎุฑ 10 ุฃุฎุทุงุก** - ุนุฑุถ ุขุฎุฑ 10 ุฃุฎุทุงุก ูุน ุงูุชูุงุตูู
- **๐ ุขุฎุฑ 20** - ุนุฑุถ ุขุฎุฑ 20 ุฎุทุฃ
- **๐ด Facebook ููุท** - ุฃุฎุทุงุก Facebook ููุท
- **๐ธ Instagram ููุท** - ุฃุฎุทุงุก Instagram ููุท
- **๐ ุชุญุฏูุซ** - ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช

---

## ๐ ููู ุงูุณุฌูุงุช (Logs)

### ูุซุงู ูู ุงูุณุฌูุงุช ุงูุฎุงุตุฉ ุจู:

```
2025-11-15 12:34:42,383 - handlers.download.download - INFO - ๐ ุนุฏุฏ ุงูููููุฒ ูู ุงูููู: 5
2025-11-15 12:34:42,383 - handlers.download.download - INFO - โ Using encrypted cookies for facebook (V5.1)
[generic] Extracting URL: https://www.facebook.com/stories/...
WARNING: [generic] Falling back on generic information extractor
ERROR: Unsupported URL: https://www.facebook.com/stories/...
```

### ๐ ุงูุชุญููู:

1. **โ ุงูููููุฒ ููุฌูุฏุฉ** (5 cookies)
2. **โ๏ธ yt-dlp ูุณุชุฎุฏู `generic` extractor** ุจุฏูุงู ูู `facebook` extractor
3. **โ ุงููุชูุฌุฉ: Unsupported URL**

### ๐ก ุงููุดููุฉ:

Facebook Stories ูุญููุฉ ุจุทุฑููุฉ ูุฎุชููุฉ ุนู Facebook Posts ุงูุนุงุฏูุฉ.
**yt-dlp ุญุงููุงู ูุง ูุฏุนู Facebook Stories ุจุดูู ุฌูุฏ.**

---

## ๐ ูุง ุงูุฌุฏูุฏ ูู ุงููุธุงูุ

### 1. **Logging ูุญุณูู ูู Stories:**

ุนูุฏ ูุญุงููุฉ ุชุญููู Storyุ ุณุชุฑู ูู ุงูุณุฌูุงุช:

```
๐ [STORY_DEBUG] Platform: facebook, URL: https://www.facebook.com/stories/...
๐ [STORY_DEBUG] Cookies loaded: True
๐ [STORY_DEBUG] YDL opts keys: ['format', 'cookiefile', 'extractor_args', ...]
๐ง [Facebook Story] Configured with allowed_extractors: ['facebook', 'facebook:story']
๐ง [Facebook Story] Cookies: โ Loaded
๐ [STORY_DEBUG] Attempting extract_info for facebook story...
```

### 2. **ุชุชุจุน ุงูุฃุฎุทุงุก ุชููุงุฆูุงู:**

ูู ุฎุทุฃ ููุณุฌู ูู `data/error_tracking.json` ูุน:
- โฐ ุงูููุช
- ๐ ููุน ุงูุฎุทุฃ
- ๐ค ูุนุฑู ุงููุณุชุฎุฏู
- ๐ ุงูุฑุงุจุท
- ๐ ุงูููุตุฉ
- ๐ ูุฆุฉ ุงูุฎุทุฃ
- ๐ ุชูุงุตูู ูุงููุฉ

### 3. **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู:**

ุงูุขู ุนูุฏ ูุดู Facebook Storyุ ุงููุณุชุฎุฏู ูุฑู:

```
โ Facebook Stories ุบูุฑ ูุฏุนููุฉ ุญุงููุงู!

๐ ุงูุชูุงุตูู ุงูุชูููุฉ:
โข yt-dlp ูุณุชุฎุฏู 'generic' extractor
โข Facebook ุญูุงูุฉ Stories ุจุทุฑููุฉ ูุฎุชููุฉ ุนู Posts
โข ุงูููููุฒ ูุญุฏูุง ุบูุฑ ูุงููุฉ ุญุงููุงู

๐ก ุญููู ุจุฏููุฉ...
```

---

## ๐ ุงููููุงุช ุงููุถุงูุฉ

### 1. `core/utils/error_tracker.py`
ูุธุงู ุชุชุจุน ุงูุฃุฎุทุงุก ุงูุฃุณุงุณู

**ุงููุธุงุฆู:**
- `ErrorTracker.track_error()` - ุชุณุฌูู ุฎุทุฃ ุนุงู
- `ErrorTracker.track_download_error()` - ุชุณุฌูู ุฎุทุฃ ุชุญููู
- `ErrorTracker.get_recent_errors()` - ุงูุญุตูู ุนูู ุฃุฎุทุงุก ุฃุฎูุฑุฉ
- `ErrorTracker.get_error_stats()` - ุฅุญุตุงุฆูุงุช ุงูุฃุฎุทุงุก

### 2. `handlers/admin/error_viewer.py`
ูุงุฌูุฉ ุนุฑุถ ุงูุฃุฎุทุงุก ูููุฏูุฑ

**ุงููุธุงุฆู:**
- `cmd_errors()` - ุฃูุฑ `/errors`
- `handle_errors_callback()` - ูุนุงูุฌ ุงูุฃุฒุฑุงุฑ

### 3. ุงูุชุนุฏููุงุช ูู `handlers/download/download.py`
- ุฅุถุงูุฉ import ููู ErrorTracker
- Logging ูุญุณูู ูุจู `extract_info()`
- ุชุชุจุน ุงูุฃุฎุทุงุก ุชููุงุฆูุงู
- ุฑุณุงุฆู ุฎุทุฃ ูุญุณููุฉ ูู Facebook Stories

### 4. ุงูุชุนุฏููุงุช ูู `bot.py`
- ุชุณุฌูู ุฃูุฑ `/errors`
- ุชุณุฌูู ูุนุงูุฌ ุงูุฃุฒุฑุงุฑ

---

## ๐งช ููู ุชุฎุชุจุฑ ุงููุธุงูุ

### 1. ุดุบูู ุงูุจูุช:
```bash
python3 bot.py
```

### 2. ุฃุฑุณู ุฑุงุจุท Facebook Story ููุจูุช

### 3. ุฑุงูุจ ุงูุณุฌูุงุช (Terminal):
ุณุชุฌุฏ:
```
๐ [STORY_DEBUG] Platform: facebook, URL: ...
๐ง [Facebook Story] Configured with allowed_extractors: ...
๐ง [Facebook Story] Cookies: โ Loaded
๐ [STORY_DEBUG] Attempting extract_info for facebook story...
๐ด [ERROR_TRACKER] DOWNLOAD_FACEBOOK
   Message: ERROR: Unsupported URL: ...
   User: 384100534
   URL: https://www.facebook.com/stories/...
```

### 4. ุงูุชุญ Telegram ูุฃุฑุณู `/errors` (ููุฏูุฑ)

ุณุชุฑู ุชูุฑูุฑ ููุตู ุจุงูุฃุฎุทุงุก!

---

## ๐ ููุงุฆุฏ ุงููุธุงู ุงูุฌุฏูุฏ

### โ ูููุฏูุฑ:
1. **ูุนุฑูุฉ ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ** - ุฃู ููุตุฉ ุชุณุจุจ ูุดุงูู ุฃูุซุฑ
2. **ุชุชุจุน ุงููุดุงูู** - ุชุงุฑูุฎ ูุงูู ููุฃุฎุทุงุก
3. **ุชุญููู ุณุฑูุน** - ุฅุญุตุงุฆูุงุช ุฌุงูุฒุฉ
4. **ุชุตููุฉ ุฐููุฉ** - ุนุฑุถ ุฃุฎุทุงุก ููุตุฉ ูุนููุฉ ููุท

### โ ูููุทูุฑ:
1. **Debugging ุฃุณูู** - logs ูุงุถุญุฉ ูููุตูุฉ
2. **ุชุญููู ุงูุฃุฎุทุงุก** - ูุนุฑูุฉ ุงูุณุจุจ ุงูุญูููู
3. **ุชุญุณูู ุงูููุฏ** - ูุนุฑูุฉ ุฃูุซุฑ ุงูุฃุฎุทุงุก ุดููุนุงู
4. **ูุซุงุฆู ุชููุงุฆูุฉ** - ูู ุฎุทุฃ ูุณุฌู ูู JSON

### โ ูููุณุชุฎุฏู:
1. **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ** - ูุนุฑู ุจุงูุถุจุท ูุง ุงููุดููุฉ
2. **ุญููู ููุชุฑุญุฉ** - ุฎุทูุงุช ูุญู ุงููุดููุฉ
3. **ุดูุงููุฉ** - ูุนุฑู ุฃู ุงููุดููุฉ ูุนุฑููุฉ ูููุนูู ุนูู ุญููุง

---

## ๐ง ุงูุฅุนุฏุงุฏุงุช

### ููู ุงูุฃุฎุทุงุก:
```
data/error_tracking.json
```

### ุญุฏ ุงูุฃุฎุทุงุก ุงููุญููุธุฉ:
```python
# ุขุฎุฑ 500 ุฎุทุฃ ููุท (ูู error_tracker.py)
errors = errors[-500:]
```

### ูุฏุฉ ุงูุฅุญุตุงุฆูุงุช:
```python
# ุขุฎุฑ 24 ุณุงุนุฉ (ูููู ุชุบููุฑูุง)
stats = ErrorTracker.get_error_stats(hours=24)
```

---

## ๐ฏ ุงูุฎุทูุงุช ุงููุงุฏูุฉ

### ููุญู ุงูููุงุฆู ูู Facebook Stories:

1. **ูุชุงุจุนุฉ ุชุญุฏูุซุงุช yt-dlp**
   - ูุฏ ูุถูููู ุฏุนู Facebook Stories ูุงุญูุงู

2. **ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุจุฏููุฉ**
   - gallery-dl
   - instaloader (ููู Instagram)
   - ุฃุฏูุงุช ูุฎุตุตุฉ

3. **Facebook Graph API**
   - ูุญุชุงุฌ access token
   - ูุนูุฏ ููู ููุซูู

4. **Web scraping ูุจุงุดุฑ**
   - ุงุณุชุฎุฑุงุฌ ุฑุงุจุท ุงูููุฏูู ูู HTML
   - ูุญุชุงุฌ ุตูุงูุฉ ูุณุชูุฑุฉ (Facebook ูุบูุฑ ุงูููุฏ)

---

## โ ุฃุณุฆูุฉ ุดุงุฆุนุฉ

### ุณ: ูู ูููู ูููุณุชุฎุฏููู ุฑุคูุฉ `/errors`ุ
**ุฌ:** ูุงุ ุงูุฃูุฑ ูููุฏุฑุงุก ููุท.

### ุณ: ุฃูู ุชูุญูุธ ุงูุฃุฎุทุงุกุ
**ุฌ:** ูู `data/error_tracking.json`

### ุณ: ูู ูุคุซุฑ ุนูู ุฃุฏุงุก ุงูุจูุชุ
**ุฌ:** ูุงุ ุงูุชุฃุซูุฑ ุถุฆูู ุฌุฏุงู (ูุฌุฑุฏ ูุชุงุจุฉ ูู ููู JSON).

### ุณ: ูู ุฎุทุฃ ููุญูุธุ
**ุฌ:** ุขุฎุฑ 500 ุฎุทุฃ ููุท (ุชููุงุฆูุงู).

### ุณ: ูู ูููู ุชุตุฏูุฑ ุงูุฃุฎุทุงุกุ
**ุฌ:** ูุนู! ุงูููู `data/error_tracking.json` ูููู ูุชุญู ูุจุงุดุฑุฉ.

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ูุดุงูู:
1. ุชุญูู ูู ุงูุณุฌูุงุช (Terminal)
2. ุงูุญุต `data/error_tracking.json`
3. ุฃุฑุณู `/errors` ููุญุตูู ุนูู ุชูุฑูุฑ
4. ุดุงุฑู ุงูุณุฌูุงุช ููุชุญููู

---

**ุชู ุฅูุดุงุคู ูู:** 2025-11-15
**ุงูุฅุตุฏุงุฑ:** 1.0
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู
